{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2>Importar PendÃªncias Financeiras</h2>
  
  <!-- Card de orientaÃ§Ãµes -->
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="mb-0">ðŸ“‹ OrientaÃ§Ãµes para ImportaÃ§Ã£o</h5>
    </div>
    <div class="card-body">
      <p class="mb-2"><strong>Antes de importar:</strong></p>
      <ul class="mb-3">
        <li>Baixe o modelo Excel oficial abaixo</li>
        <li>Preencha com seus dados seguindo o exemplo</li>
        <li><strong>Importante:</strong> O sistema lÃª pela posiÃ§Ã£o das colunas:
          <ul>
            <li><span class="badge bg-info">Coluna A</span> = NÃºmero da NF (somente nÃºmeros)</li>
            <li><span class="badge bg-info">Coluna B</span> = ObservaÃ§Ã£o da pendÃªncia</li>
          </ul>
        </li>
      </ul>
      <a href="{{ url_for('financeiro.baixar_modelo_pendencias') }}" class="btn btn-success btn-sm">
        <i class="fas fa-download"></i> Baixar Modelo Excel
      </a>
    </div>
  </div>

  <!-- FormulÃ¡rio de importaÃ§Ã£o -->
  <div class="card">
    <div class="card-header">
      <h5 class="mb-0">ðŸ“¤ Importar Arquivo</h5>
    </div>
    <div class="card-body">
      <form method="POST" enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        {{ form.hidden_tag() }}
        <div class="mb-3">
          <label for="arquivo" class="form-label">Selecione o arquivo Excel (.xlsx)</label>
          <input class="form-control" type="file" name="arquivo" accept=".xlsx" required>
          <div class="form-text">Arquivo deve estar no formato do modelo oficial.</div>
        </div>
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-upload"></i> Importar PendÃªncias
        </button>
        <a href="{{ url_for('financeiro.consultar_pendencias') }}" class="btn btn-secondary ms-2">
          <i class="fas fa-list"></i> Ver PendÃªncias
        </a>
      </form>
    </div>
  </div>
</div>
{% endblock %}
