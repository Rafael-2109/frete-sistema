{% extends "base.html" %}

{% block title %}Portal Sendas - Gerenciar Filiais{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4 mt-3">
        <h1 class="h3">Portal Sendas - Gerenciar Filiais</h1>
        <a href="{{ url_for('portal.central_portais') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Voltar à Central
        </a>
    </div>
    
    <div class="row">
        <!-- Card Principal De-Para Filiais -->
        <div class="col-md-8 mb-4">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-store"></i> De-Para Filiais Sendas
                    </h5>
                </div>
                <div class="card-body">
                    <p class="card-text">
                        O De-Para de Filiais converte CNPJs para códigos de filiais reconhecidos 
                        pelo portal do Sendas, identificando corretamente o destino da entrega.
                    </p>
                    
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i> <strong>Atenção:</strong> 
                        Certifique-se de cadastrar todas as filiais ativas do Sendas para garantir o funcionamento correto dos agendamentos.
                    </div>

                    <div class="btn-group-vertical w-100">
                        <a href="{{ url_for('portal.sendas_depara.listar_filiais') }}" class="btn btn-outline-success text-start">
                            <i class="fas fa-list"></i> Listar Filiais
                            <small class="d-block text-muted">Visualize e gerencie todos os mapeamentos de filiais</small>
                        </a>
                        <a href="{{ url_for('portal.sendas_depara.nova_filial') }}" class="btn btn-outline-success text-start">
                            <i class="fas fa-plus"></i> Nova Filial
                            <small class="d-block text-muted">Cadastre um novo mapeamento de filial</small>
                        </a>
                        <a href="{{ url_for('portal.sendas_depara.importar_filiais') }}" class="btn btn-outline-info text-start">
                            <i class="fas fa-file-excel"></i> Importar CSV ou XLSX
                            <small class="d-block text-muted">Importe múltiplas filiais via arquivo</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Card de Estatísticas -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-bar"></i> Estatísticas
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2">
                            <i class="fas fa-check-circle text-success"></i>
                            <strong>Total de Filiais:</strong> 
                            <span class="badge bg-primary">{{ total_filiais | default(0) }}</span>
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-toggle-on text-success"></i>
                            <strong>Filiais Ativas:</strong> 
                            <span class="badge bg-success">{{ filiais_ativas | default(0) }}</span>
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-toggle-off text-danger"></i>
                            <strong>Filiais Inativas:</strong> 
                            <span class="badge bg-danger">{{ filiais_inativas | default(0) }}</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Card de Instruções -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-question-circle"></i> Como Funciona o De-Para de Filiais
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <h6><i class="fas fa-1 text-success"></i> Mapeamento CNPJ → Filial</h6>
                            <p class="small">Cadastre o CNPJ da filial e o código correspondente usado no portal Sendas.</p>
                        </div>
                        <div class="col-md-4">
                            <h6><i class="fas fa-2 text-success"></i> Identificação Automática</h6>
                            <p class="small">Durante o agendamento, o sistema identifica automaticamente a filial pelo CNPJ.</p>
                        </div>
                        <div class="col-md-4">
                            <h6><i class="fas fa-3 text-success"></i> Destino Correto</h6>
                            <p class="small">O portal do Sendas recebe o código correto da filial para entrega.</p>
                        </div>
                    </div>

                    <hr>

                    <h6><i class="fas fa-info-circle"></i> Informações Importantes:</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <ul class="small">
                                <li><strong>CNPJ:</strong> Pode ser informado com ou sem formatação</li>
                                <li><strong>Código Filial:</strong> Deve ser exatamente como usado no portal</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <ul class="small">
                                <li><strong>Campos Opcionais:</strong> Nome, Cidade e UF para melhor identificação</li>
                                <li><strong>Único:</strong> Cada CNPJ e código devem ser únicos</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
$(document).ready(function() {
    // Adicionar animação aos cards
    $('.card').addClass('animate__animated animate__fadeIn');
});
</script>
{% endblock %}