---
phase: 04-layout-patterns
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/static/css/components/_layout.css
  - app/static/css/main.css
autonomous: true

must_haves:
  truths:
    - "Content area utilities prevent horizontal overflow"
    - "Z-index scale is documented for consistent stacking context"
    - "Layout utilities are available via main.css import"
  artifacts:
    - path: "app/static/css/components/_layout.css"
      provides: "Layout utilities and z-index documentation"
      contains: ".nc-content"
    - path: "app/static/css/main.css"
      provides: "Import statement for _layout.css"
      contains: "_layout.css"
  key_links:
    - from: "app/static/css/components/_layout.css"
      to: "Design tokens (--bg-light, --border)"
      via: "CSS custom properties"
      pattern: "var\\(--"
    - from: "app/static/css/main.css"
      to: "app/static/css/components/_layout.css"
      via: "@import layer(components)"
      pattern: "@import.*_layout\\.css.*layer\\(components\\)"
---

<objective>
Create layout utilities CSS file with overflow protection and z-index documentation.

Purpose: Provide reusable layout utilities that prevent content overflow issues (LAYO-03 completion) and document the z-index scale for consistent stacking context across the system. This completes the Layout Patterns phase requirements.

Output: New `_layout.css` component file and main.css integration.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-layout-patterns/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create _layout.css component file</name>
  <files>app/static/css/components/_layout.css</files>
  <action>
Create a new file `app/static/css/components/_layout.css` with the following content:

```css
@layer components {
/* ═══════════════════════════════════════════════════════════════════════════
   LAYOUT - Page structure utilities and z-index scale

   Provides:
   - Content overflow protection (.nc-content)
   - Full-height page layout (.nc-page)
   - Z-index scale documentation

   Usage:
   - Apply .nc-content to any container that may have wide content
   - Apply .nc-page to main content wrapper for full-height layouts
   ═══════════════════════════════════════════════════════════════════════════ */

/* ═══════════════════════════════════════════════════════════════════════════
   Z-INDEX SCALE

   Bootstrap defaults:
   1055 - Modals
   1050 - Modal backdrop
   1045 - Offcanvas
   1040 - Offcanvas backdrop
   1030 - Navbar (fixed/sticky)
   1020 - Sticky elements (not navbar)
   1000 - Dropdown menus

   Custom additions:
   1011 - Table sticky corner cell (th:first-child in sticky-both)
   1010 - Table sticky headers (thead th)
   1005 - Table sticky first column (tbody td:first-child)

   Rule: Never use z-index values above 1055 unless for critical overlays.
   ═══════════════════════════════════════════════════════════════════════════ */


/* ═══════════════════════════════════════════════════════════════════════════
   CONTENT OVERFLOW PROTECTION
   ═══════════════════════════════════════════════════════════════════════════ */

/* Prevents horizontal overflow while allowing scroll when needed */
.nc-content {
    overflow-x: auto;
    max-width: 100%;
}

/* Strict containment - clips overflow without scroll */
.nc-content-clip {
    overflow-x: hidden;
    max-width: 100%;
}

/* Word break for long text content */
.nc-content-wrap {
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
}


/* ═══════════════════════════════════════════════════════════════════════════
   PAGE STRUCTURE
   ═══════════════════════════════════════════════════════════════════════════ */

/* Full-height page layout accounting for navbar */
.nc-page {
    min-height: calc(100vh - 56px); /* 56px = navbar height */
    display: flex;
    flex-direction: column;
}

/* Modern viewport units with fallback */
@supports (min-height: 100dvh) {
    .nc-page {
        min-height: calc(100dvh - 56px);
    }
}

/* Main content area that fills remaining space */
.nc-page-content {
    flex: 1;
    padding: 1rem;
}

/* Sticky footer pattern */
.nc-page-footer {
    margin-top: auto;
}


/* ═══════════════════════════════════════════════════════════════════════════
   CONTAINER HELPERS
   ═══════════════════════════════════════════════════════════════════════════ */

/* Remove Bootstrap container max-width for full-width layouts */
.nc-container-full {
    max-width: none;
    width: 100%;
}

/* Centered content with readable line length */
.nc-container-readable {
    max-width: 75ch;
    margin-left: auto;
    margin-right: auto;
}


/* ═══════════════════════════════════════════════════════════════════════════
   RESPONSIVE ADJUSTMENTS
   ═══════════════════════════════════════════════════════════════════════════ */

@media (max-width: 767.98px) {
    .nc-page-content {
        padding: 0.75rem;
    }

    /* Tighter margins on mobile */
    .nc-container-readable {
        padding-left: 1rem;
        padding-right: 1rem;
    }
}


/* ═══════════════════════════════════════════════════════════════════════════
   REDUCED MOTION
   ═══════════════════════════════════════════════════════════════════════════ */

@media (prefers-reduced-motion: reduce) {
    .nc-content,
    .nc-page {
        transition: none;
    }
}

} /* End @layer components */
```

This file establishes:
1. Z-index scale documentation (comment block for reference)
2. Content overflow utilities (.nc-content, .nc-content-clip, .nc-content-wrap)
3. Page structure utilities (.nc-page, .nc-page-content, .nc-page-footer)
4. Container helpers (.nc-container-full, .nc-container-readable)
5. Responsive adjustments and reduced motion support
  </action>
  <verify>
```bash
test -f app/static/css/components/_layout.css && echo "File created"
grep -q ".nc-content" app/static/css/components/_layout.css && echo "Content utility present"
grep -q ".nc-page" app/static/css/components/_layout.css && echo "Page utility present"
grep -q "Z-INDEX SCALE" app/static/css/components/_layout.css && echo "Z-index documented"
grep -q "@layer components" app/static/css/components/_layout.css && echo "Layer wrapper present"
```
  </verify>
  <done>
_layout.css created with overflow protection utilities and z-index documentation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add _layout.css import to main.css</name>
  <files>app/static/css/main.css</files>
  <action>
Add the import statement for `_layout.css` in the Components section of main.css.

Find the existing component imports (around line 48-54):
```css
/* Components - Reusable UI patterns */
@import url('./components/_buttons.css') layer(components);
@import url('./components/_cards.css') layer(components);
@import url('./components/_badges.css') layer(components);
@import url('./components/_modals.css') layer(components);
@import url('./components/_forms.css') layer(components);
@import url('./components/_tables.css') layer(components);
```

Add the layout import AFTER the existing components (since it's a new addition):
```css
@import url('./components/_layout.css') layer(components);
```

The final component section should look like:
```css
/* Components - Reusable UI patterns */
@import url('./components/_buttons.css') layer(components);
@import url('./components/_cards.css') layer(components);
@import url('./components/_badges.css') layer(components);
@import url('./components/_modals.css') layer(components);
@import url('./components/_forms.css') layer(components);
@import url('./components/_tables.css') layer(components);
@import url('./components/_layout.css') layer(components);
```
  </action>
  <verify>
```bash
grep -q "@import url('./components/_layout.css') layer(components)" app/static/css/main.css && echo "Import added"
grep -c "@import.*components/" app/static/css/main.css
# Expected: 7 (buttons, cards, badges, modals, forms, tables, layout)
```
  </verify>
  <done>
main.css imports _layout.css in the components layer, making layout utilities available system-wide.
  </done>
</task>

</tasks>

<verification>
```bash
# Verify _layout.css exists and has required content
test -f app/static/css/components/_layout.css && echo "File exists"
grep -c "\.nc-" app/static/css/components/_layout.css
# Expected: at least 6 (.nc-content, .nc-content-clip, etc.)

# Verify z-index documentation
grep -q "1055 - Modals" app/static/css/components/_layout.css && echo "Z-index scale documented"

# Verify main.css integration
grep "@import.*_layout" app/static/css/main.css
# Expected: uncommented import line

# Verify @layer wrapper
grep -q "@layer components" app/static/css/components/_layout.css && echo "Layer present"

# Verify no !important usage
grep -c "!important" app/static/css/components/_layout.css
# Expected: 0
```
</verification>

<success_criteria>
1. `_layout.css` file exists in `app/static/css/components/`
2. Z-index scale is documented as comment block
3. Content overflow utilities (.nc-content, .nc-content-clip) are defined
4. Page structure utilities (.nc-page, .nc-page-content) are defined
5. main.css imports _layout.css in components layer
6. Zero `!important` declarations in _layout.css
</success_criteria>

<output>
After completion, create `.planning/phases/04-layout-patterns/04-02-SUMMARY.md`
</output>
