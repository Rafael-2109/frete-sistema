---
phase: 04-layout-patterns
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/static/css/base/_navbar.css
autonomous: true

must_haves:
  truths:
    - "Navbar dropdown items have minimum 44x44px touch targets on mobile"
    - "Dropdowns work correctly on touch devices without hover dependency"
    - "Mobile collapsed menu has proper spacing and touch usability"
  artifacts:
    - path: "app/static/css/base/_navbar.css"
      provides: "Mobile-optimized navbar with touch-friendly targets"
      contains: "min-height: 44px"
  key_links:
    - from: "app/static/css/base/_navbar.css"
      to: "Design tokens (--bs-primary, --bs-border-color)"
      via: "CSS custom properties"
      pattern: "var\\(--bs"
---

<objective>
Optimize navbar for mobile touch usability while keeping desktop behavior unchanged.

Purpose: Ensure navbar dropdowns and menu items meet WCAG 2.5.5 touch target requirements (44x44px minimum) and work correctly on touch devices. The current navbar uses Bootstrap collapse which works, but touch targets need optimization.

Output: Enhanced `_navbar.css` with mobile-specific touch optimizations.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-layout-patterns/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add mobile touch target optimization to _navbar.css</name>
  <files>app/static/css/base/_navbar.css</files>
  <action>
Enhance the existing RESPONSIVE STYLES section in `_navbar.css` (currently at line 370-407) with touch-optimized targets.

1. **Find the existing `@media (max-width: 991.98px)` block** and add/modify:

```css
/* Touch-friendly dropdown items - WCAG 2.5.5 compliant (44x44px minimum) */
.nc-navbar .dropdown-item {
    min-height: 44px;
    padding: 0.75rem 1rem;
    display: flex;
    align-items: center;
}

/* Touch-friendly nav links */
.nc-navbar .nav-link {
    min-height: 44px;
    padding: 0.875rem 1rem;
}

/* Larger touch target for dropdown toggle */
.nc-navbar .dropdown-toggle {
    min-height: 44px;
}
```

2. **Add a new section for touch device improvements** after the responsive styles:

```css
/* ==========================================================================
   TOUCH DEVICE OPTIMIZATIONS
   ========================================================================== */

/* Remove hover-dependent effects on touch devices */
@media (hover: none) {
    .nc-navbar .dropdown-item:hover {
        transform: none;  /* Disable translateX effect on touch */
    }

    /* Ensure dropdown works on tap, not hover */
    .nc-navbar .nav-item.dropdown > .dropdown-menu {
        /* Bootstrap handles show/hide via JS, but ensure no hover interference */
    }
}

/* Improve touch feedback */
@media (hover: none) and (pointer: coarse) {
    .nc-navbar .dropdown-item:active,
    .nc-navbar .nav-link:active {
        background: rgba(var(--bs-primary-rgb), 0.15);
        transition: background-color 0.1s ease;
    }
}
```

3. **Ensure existing `.nc-navbar .navbar-toggler` block** has sufficient touch target:

```css
.nc-navbar .navbar-toggler {
    min-width: 44px;
    min-height: 44px;
    padding: 0.5rem 0.75rem;
}
```

Keep all existing desktop styles unchanged. Only add/enhance mobile-specific rules.
  </action>
  <verify>
```bash
grep -q "min-height: 44px" app/static/css/base/_navbar.css && echo "Touch targets added"
grep -q "@media (hover: none)" app/static/css/base/_navbar.css && echo "Touch media query present"
grep -q "pointer: coarse" app/static/css/base/_navbar.css && echo "Coarse pointer detection"
```
  </verify>
  <done>
Mobile touch targets meet WCAG 2.5.5 (44x44px minimum) and touch-specific optimizations are in place.
  </done>
</task>

<task type="auto">
  <name>Task 2: Improve mobile collapsed menu spacing</name>
  <files>app/static/css/base/_navbar.css</files>
  <action>
Enhance the existing mobile collapsed menu styles in the `@media (max-width: 991.98px)` block.

1. **Find and update the `.nc-navbar .navbar-collapse` rule** to improve spacing:

```css
.nc-navbar .navbar-collapse {
    background: var(--bs-secondary-bg);
    border-radius: var(--bs-border-radius-lg);
    padding: 1rem;
    margin-top: 0.75rem;
    border: 1px solid var(--bs-border-color);
    box-shadow: var(--bs-box-shadow-lg, 0 10px 25px rgba(0,0,0,0.2));
    /* Add max-height with scroll for very long menus */
    max-height: calc(100vh - 80px);
    overflow-y: auto;
}
```

2. **Improve dropdown header visibility in mobile**:

```css
.nc-navbar .dropdown-header {
    padding: 0.75rem 1rem 0.5rem;
    font-size: 0.7rem;
}
```

3. **Ensure dropdown dividers have proper spacing**:

```css
.nc-navbar .dropdown-divider {
    margin: 0.5rem 0;
}
```

These changes should be inside the existing `@media (max-width: 991.98px)` block.
  </action>
  <verify>
```bash
grep -q "max-height: calc(100vh" app/static/css/base/_navbar.css && echo "Max height scroll present"
grep -q "overflow-y: auto" app/static/css/base/_navbar.css && echo "Overflow scroll enabled"
```
  </verify>
  <done>
Mobile collapsed menu has proper max-height, scrolling, and improved spacing for usability.
  </done>
</task>

</tasks>

<verification>
```bash
# Verify touch target implementation
grep -c "min-height: 44px" app/static/css/base/_navbar.css
# Expected: at least 3 (dropdown-item, nav-link, navbar-toggler)

# Verify touch media queries
grep -c "hover: none" app/static/css/base/_navbar.css
# Expected: at least 2

# Verify mobile scroll handling
grep -q "overflow-y: auto" app/static/css/base/_navbar.css && echo "Mobile scroll OK"

# Verify no !important added (layer system handles specificity)
grep -c "!important" app/static/css/base/_navbar.css
# Expected: Same as before (only the existing margin-top on dropdown-menu)
```
</verification>

<success_criteria>
1. All mobile touch targets are minimum 44x44px (WCAG 2.5.5)
2. Touch devices have optimized feedback (no hover effects that don't work)
3. Mobile collapsed menu scrolls when content exceeds viewport
4. No new `!important` declarations added
5. Desktop navbar behavior remains unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/04-layout-patterns/04-01-SUMMARY.md`
</output>
