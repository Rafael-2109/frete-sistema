---
phase: 05-high-traffic-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/static/css/modules/_financeiro.css
  - app/static/css/modules/_carteira.css
  - app/static/css/modules/_embarques.css
  - app/static/css/main.css
autonomous: true

must_haves:
  truths:
    - "Module CSS files exist for financeiro, carteira, and embarques"
    - "main.css imports all three module files in @layer modules"
    - "Module files use @layer modules wrapper for correct specificity"
  artifacts:
    - path: "app/static/css/modules/_financeiro.css"
      provides: "Financeiro module overrides"
      contains: "@layer modules"
    - path: "app/static/css/modules/_carteira.css"
      provides: "Carteira module overrides"
      contains: "@layer modules"
    - path: "app/static/css/modules/_embarques.css"
      provides: "Embarques module overrides"
      contains: "@layer modules"
    - path: "app/static/css/main.css"
      provides: "Module imports in correct layer"
      contains: "_financeiro.css"
  key_links:
    - from: "app/static/css/main.css"
      to: "app/static/css/modules/_financeiro.css"
      via: "@import url('./modules/_financeiro.css') layer(modules)"
      pattern: "@import.*_financeiro.*layer\\(modules\\)"
---

<objective>
Create module CSS files for financeiro, carteira, and embarques, and integrate them into main.css

Purpose: Establish the CSS infrastructure that will receive migrated styles from templates
Output: Three module CSS files with proper @layer modules wrapper, integrated into main.css
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-high-traffic-migration/05-RESEARCH.md
@app/static/css/main.css
@app/static/css/components/_badges.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create module CSS files</name>
  <files>
    app/static/css/modules/_financeiro.css
    app/static/css/modules/_carteira.css
    app/static/css/modules/_embarques.css
  </files>
  <action>
Create three module CSS files following the established pattern from _badges.css.

For _financeiro.css:
```css
/**
 * _financeiro.css - Financeiro Module Overrides
 *
 * Component overrides specific to the financeiro module.
 * Styles extracted from template <style> blocks during migration.
 *
 * Token mapping:
 * - Use var(--bg-light) for card backgrounds
 * - Use var(--text) for primary text
 * - Use var(--text-muted) for secondary text
 * - Use var(--border) for borders
 * - Use var(--semantic-success/danger) for status colors
 * - Use var(--amber-50/55) for accent colors
 */

@layer modules {

  /* ═══════════════════════════════════════════════════════════════════════════
     FINANCEIRO MODULE - Component overrides
     Migrated from template inline styles
     ═══════════════════════════════════════════════════════════════════════════ */

  /* Placeholder - styles will be added as templates are migrated */

} /* End @layer modules */
```

For _carteira.css:
```css
/**
 * _carteira.css - Carteira Module Overrides
 *
 * Component overrides specific to the carteira module.
 * NOTE: agrupados.css exists but is NOT layered - consider consolidating.
 *
 * Token mapping:
 * - Use var(--bg-light) for card backgrounds
 * - Use var(--text) for primary text
 * - Use var(--text-muted) for secondary text
 * - Use var(--border) for borders
 * - Use var(--semantic-success/danger) for status colors
 */

@layer modules {

  /* ═══════════════════════════════════════════════════════════════════════════
     CARTEIRA MODULE - Component overrides
     Migrated from template inline styles
     ═══════════════════════════════════════════════════════════════════════════ */

  /* Placeholder - styles will be added as templates are migrated */

} /* End @layer modules */
```

For _embarques.css:
```css
/**
 * _embarques.css - Embarques Module Overrides
 *
 * Component overrides specific to the embarques module.
 * NOTE: Print templates (imprimir_*.html) are NOT migrated - they keep
 * hardcoded light mode colors for print reliability.
 *
 * Token mapping:
 * - Use var(--bg-light) for card backgrounds
 * - Use var(--text) for primary text
 * - Use var(--text-muted) for secondary text
 * - Use var(--border) for borders
 */

@layer modules {

  /* ═══════════════════════════════════════════════════════════════════════════
     EMBARQUES MODULE - Component overrides
     Migrated from template inline styles
     EXCLUDES: imprimir_*.html (print templates keep hardcoded colors)
     ═══════════════════════════════════════════════════════════════════════════ */

  /* Placeholder - styles will be added as templates are migrated */

} /* End @layer modules */
```
  </action>
  <verify>
    ls -la app/static/css/modules/_financeiro.css app/static/css/modules/_carteira.css app/static/css/modules/_embarques.css
    grep "@layer modules" app/static/css/modules/_financeiro.css
  </verify>
  <done>Three module CSS files exist with @layer modules wrapper</done>
</task>

<task type="auto">
  <name>Task 2: Integrate modules into main.css</name>
  <files>app/static/css/main.css</files>
  <action>
Add imports for the three module CSS files to main.css.

Insert after the components imports and before the utilities import:

```css
/* Modules - Feature-specific styles */
@import url('./modules/_financeiro.css') layer(modules);
@import url('./modules/_carteira.css') layer(modules);
@import url('./modules/_embarques.css') layer(modules);
```

The final order should be:
1. @layer declaration
2. Fonts import
3. Tokens import
4. Base imports
5. Components imports
6. **Modules imports** (new)
7. Utilities import
  </action>
  <verify>
    grep -A3 "Modules -" app/static/css/main.css
    grep "_financeiro.css" app/static/css/main.css
  </verify>
  <done>main.css imports all three module files in layer(modules)</done>
</task>

</tasks>

<verification>
1. Run: `grep "@layer modules" app/static/css/modules/_financeiro.css app/static/css/modules/_carteira.css app/static/css/modules/_embarques.css`
   Expected: Each file shows @layer modules

2. Run: `grep "layer(modules)" app/static/css/main.css | wc -l`
   Expected: At least 3 lines (the three module imports)

3. Visual check: Load any page in browser, open DevTools > Sources > main.css
   Expected: Module imports visible, no 404 errors in console
</verification>

<success_criteria>
- Three module CSS files created in app/static/css/modules/
- Each file wrapped in @layer modules
- main.css imports all three files with layer(modules)
- No console errors when loading the site
</success_criteria>

<output>
After completion, create `.planning/phases/05-high-traffic-migration/05-01-SUMMARY.md`
</output>
