---
phase: 01-layer-infrastructure
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/templates/base.html
  - app/templates/carteira/mapa_pedidos.html
  - app/templates/portal/sendas/gerenciar_sessao.html
  - app/templates/rastreamento/rastreamento_ativo.html
  - app/templates/rastreamento/upload_canhoto.html
  - app/templates/rastreamento/questionario_entrega.html
  - app/templates/rastreamento/erro.html
  - app/templates/rastreamento/aceite_lgpd.html
  - app/templates/rastreamento/confirmacao.html
  - app/templates/manufatura/programacao_linhas_print.html
autonomous: true

must_haves:
  truths:
    - "All templates load Bootstrap 5.3.3 (no 5.1.3 or 5.3.0 or 5.3.2)"
    - "Bootstrap JS also updated to 5.3.3 where present"
    - "No mixed Bootstrap versions across the application"
  artifacts:
    - path: "app/templates/base.html"
      provides: "Main template with Bootstrap 5.3.3"
      contains: "bootstrap@5.3.3"
    - path: "app/templates/carteira/mapa_pedidos.html"
      provides: "Standalone template with Bootstrap 5.3.3"
      contains: "bootstrap@5.3.3"
    - path: "app/templates/rastreamento/rastreamento_ativo.html"
      provides: "Standalone template with Bootstrap 5.3.3"
      contains: "bootstrap@5.3.3"
  key_links:
    - from: "All templates"
      to: "Bootstrap 5.3.3 CDN"
      via: "link href and script src"
      pattern: "bootstrap@5\\.3\\.3"
---

<objective>
Standardize Bootstrap version to 5.3.3 across ALL templates, eliminating the current mix of 5.1.3, 5.3.0, and 5.3.2.

Purpose: Ensure consistent CSS variable support and `data-bs-theme` dark mode functionality across all pages. Bootstrap 5.1.x lacks these features, causing dark mode to fail on standalone pages.

Output: All 10 identified templates updated to Bootstrap 5.3.3 (CSS and JS)
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-layer-infrastructure/01-RESEARCH.md

# Templates to update (from research)
# Version inventory:
# - base.html: 5.3.2 -> 5.3.3
# - mapa_pedidos.html: 5.1.3 -> 5.3.3
# - gerenciar_sessao.html: 5.1.3 -> 5.3.3
# - rastreamento/*.html (6 files): 5.3.0 -> 5.3.3
# - programacao_linhas_print.html: 5.3.0 -> 5.3.3
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update base.html to Bootstrap 5.3.3</name>
  <files>app/templates/base.html</files>
  <action>
Update Bootstrap references in base.html from 5.3.2 to 5.3.3.

Find and replace:
```html
<!-- BEFORE -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- AFTER -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
```

This is a minor version bump (5.3.2 -> 5.3.3), no breaking changes expected.
  </action>
  <verify>
```bash
# Verify Bootstrap version in base.html
grep -E "bootstrap@5\.[0-9]+\.[0-9]+" app/templates/base.html
# Should show only 5.3.3
```
  </verify>
  <done>
base.html loads Bootstrap 5.3.3 for both CSS and JS.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update standalone templates to Bootstrap 5.3.3</name>
  <files>
    app/templates/carteira/mapa_pedidos.html
    app/templates/portal/sendas/gerenciar_sessao.html
    app/templates/rastreamento/rastreamento_ativo.html
    app/templates/rastreamento/upload_canhoto.html
    app/templates/rastreamento/questionario_entrega.html
    app/templates/rastreamento/erro.html
    app/templates/rastreamento/aceite_lgpd.html
    app/templates/rastreamento/confirmacao.html
    app/templates/manufatura/programacao_linhas_print.html
  </files>
  <action>
Update Bootstrap references in all 9 standalone templates.

**For templates with Bootstrap 5.1.3:**
```html
<!-- BEFORE -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- AFTER -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
```

**For templates with Bootstrap 5.3.0:**
```html
<!-- BEFORE -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- AFTER -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
```

Files to update and their current versions:
1. `carteira/mapa_pedidos.html` - 5.1.3 -> 5.3.3
2. `portal/sendas/gerenciar_sessao.html` - 5.1.3 -> 5.3.3
3. `rastreamento/rastreamento_ativo.html` - 5.3.0 -> 5.3.3
4. `rastreamento/upload_canhoto.html` - 5.3.0 -> 5.3.3
5. `rastreamento/questionario_entrega.html` - 5.3.0 -> 5.3.3
6. `rastreamento/erro.html` - 5.3.0 -> 5.3.3
7. `rastreamento/aceite_lgpd.html` - 5.3.0 -> 5.3.3
8. `rastreamento/confirmacao.html` - 5.3.0 -> 5.3.3
9. `manufatura/programacao_linhas_print.html` - 5.3.0 -> 5.3.3

**Important considerations for 5.1.3 -> 5.3.3 upgrades:**
- Bootstrap 5.3+ uses `data-bs-theme` for dark mode (didn't exist in 5.1.x)
- CSS variable names are consistent between 5.3.0 and 5.3.3
- JS API is backward compatible
- These standalone templates don't use base.html's design tokens yet (future phase)
  </action>
  <verify>
```bash
# Verify no old Bootstrap versions remain
echo "=== Checking for old Bootstrap versions ==="
grep -r "bootstrap@5\.1\." app/templates/ && echo "FAIL: Found 5.1.x" || echo "OK: No 5.1.x found"
grep -r "bootstrap@5\.3\.0" app/templates/ && echo "FAIL: Found 5.3.0" || echo "OK: No 5.3.0 found"
grep -r "bootstrap@5\.3\.2" app/templates/ && echo "FAIL: Found 5.3.2" || echo "OK: No 5.3.2 found"

echo ""
echo "=== Checking Bootstrap 5.3.3 is present ==="
grep -r "bootstrap@5\.3\.3" app/templates/ | wc -l
# Should show 10+ occurrences (CSS + JS for each template)
```
  </verify>
  <done>
All 9 standalone templates load Bootstrap 5.3.3 for both CSS and JS.
  </done>
</task>

</tasks>

<verification>
Run these checks to verify Phase 1, Plan 02 completion:

```bash
# 1. Check for any non-5.3.3 Bootstrap versions
echo "=== Checking for mixed Bootstrap versions ==="
FOUND_OLD=$(grep -r "bootstrap@5\." app/templates/ | grep -v "5\.3\.3" | wc -l)
if [ "$FOUND_OLD" -eq 0 ]; then
  echo "OK: No old Bootstrap versions found"
else
  echo "FAIL: Found $FOUND_OLD old Bootstrap references:"
  grep -r "bootstrap@5\." app/templates/ | grep -v "5\.3\.3"
fi

# 2. Count 5.3.3 references
echo ""
echo "=== Bootstrap 5.3.3 usage count ==="
CSS_COUNT=$(grep -r "bootstrap@5\.3\.3/dist/css" app/templates/ | wc -l)
JS_COUNT=$(grep -r "bootstrap@5\.3\.3/dist/js" app/templates/ | wc -l)
echo "CSS links: $CSS_COUNT"
echo "JS scripts: $JS_COUNT"
# Expect: CSS >= 10, JS >= 10 (some templates may have CSS only)

# 3. Verify specific templates
echo ""
echo "=== Template-by-template check ==="
for template in "base.html" "carteira/mapa_pedidos.html" "portal/sendas/gerenciar_sessao.html" \
  "rastreamento/rastreamento_ativo.html" "rastreamento/upload_canhoto.html" \
  "rastreamento/questionario_entrega.html" "rastreamento/erro.html" \
  "rastreamento/aceite_lgpd.html" "rastreamento/confirmacao.html" \
  "manufatura/programacao_linhas_print.html"; do
  if grep -q "bootstrap@5\.3\.3" "app/templates/$template" 2>/dev/null; then
    echo "OK: $template"
  else
    echo "MISSING: $template"
  fi
done
```
</verification>

<success_criteria>
1. base.html uses Bootstrap 5.3.3 (CSS and JS)
2. All 9 standalone templates use Bootstrap 5.3.3
3. No references to Bootstrap 5.1.3, 5.3.0, or 5.3.2 remain
4. Existing functionality unchanged (version bump is backward compatible)
5. `data-bs-theme` attribute will work on all pages (5.3.3 required)
</success_criteria>

<output>
After completion, create `.planning/phases/01-layer-infrastructure/01-02-SUMMARY.md`
</output>
