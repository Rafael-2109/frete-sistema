---
phase: 03-table-system
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - app/static/css/components/_tables.css
  - app/static/css/main.css
autonomous: true

must_haves:
  truths:
    - "Long tables have sticky headers that remain visible while scrolling"
    - "Table row hover states are visible in both dark and light modes"
    - "Table component is imported in main.css and available system-wide"
  artifacts:
    - path: "app/static/css/components/_tables.css"
      provides: "Sticky headers and theme-adaptive hover states"
      contains: "position: sticky"
    - path: "app/static/css/main.css"
      provides: "Import statement for _tables.css"
      contains: "_tables.css"
  key_links:
    - from: "app/static/css/components/_tables.css"
      to: "Design tokens (--bg-light, --text, --border)"
      via: "CSS custom properties"
      pattern: "var\\(--bg-light\\)"
    - from: "app/static/css/main.css"
      to: "app/static/css/components/_tables.css"
      via: "@import layer(components)"
      pattern: "@import.*_tables\\.css.*layer\\(components\\)"
---

<objective>
Add sticky headers and theme-adaptive hover states to the table component, then integrate into main.css.

Purpose: Complete the table system by implementing sticky headers that remain visible during vertical scroll (TABL-02) and hover states that adapt to dark/light themes (TABL-03). Final integration makes the component available across all templates.

Output: Complete `_tables.css` with sticky headers and hover states, plus main.css import statement.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-table-system/03-RESEARCH.md
@.planning/phases/03-table-system/03-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add sticky headers to _tables.css</name>
  <files>app/static/css/components/_tables.css</files>
  <action>
Add a new section "STICKY HEADER" to `_tables.css` (inside the existing `@layer components` block):

1. **Sticky header on `<th>` elements** (NOT `<thead>` or `<tr>` - CSS spec limitation):
```css
.table > thead th {
  position: sticky;
  top: 0;
  background: var(--bg-light);  /* MUST be solid, not transparent */
  color: var(--text);
  font-weight: 600;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  border-bottom: 2px solid var(--border);
  z-index: 10;
}
```

2. **Optional: Sticky first column variant** (for wide tables that need horizontal + vertical freeze):
```css
.table-sticky-both > thead th:first-child {
  left: 0;
  z-index: 11;  /* Corner cell highest */
}

.table-sticky-both > tbody td:first-child {
  position: sticky;
  left: 0;
  background: var(--bg-light);
  z-index: 5;
  border-right: 2px solid var(--border);
}
```

Use the exact patterns from 03-RESEARCH.md Example 1 (STICKY HEADER section) and Example 2 (Sticky Header + Sticky First Column).
  </action>
  <verify>
```bash
grep -q "position: sticky" app/static/css/components/_tables.css && echo "Sticky present"
grep -q "thead th" app/static/css/components/_tables.css && echo "Targets th elements"
grep -q "z-index: 10" app/static/css/components/_tables.css && echo "Z-index set"
```
  </verify>
  <done>
Sticky header implementation complete with proper z-index hierarchy and solid background.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add theme-adaptive hover states to _tables.css</name>
  <files>app/static/css/components/_tables.css</files>
  <action>
Add a new section "HOVER STATES" to `_tables.css` (inside the existing `@layer components` block):

1. **Base hover with transition**:
```css
.table > tbody > tr {
  transition: background-color 0.15s ease;
}
```

2. **Low-specificity hover using :where()** (Phase 2 pattern):
```css
.table > tbody > tr:where(:hover) {
  background-color: var(--_table-hover-bg);
}
```

3. **Theme-specific hover intensities**:
```css
/* Dark mode: lighter overlay for visibility */
[data-bs-theme="dark"] .table {
  --_table-hover-bg: hsla(0 0% 100% / 0.05);
}

/* Light mode: darker overlay */
[data-bs-theme="light"] .table {
  --_table-hover-bg: hsla(0 0% 0% / 0.04);
}
```

4. **Status row colors** (table-success, table-warning, table-primary) that work in both themes:
```css
.table-success {
  --_row-bg: hsla(145 50% 35% / 0.15);
  --_row-hover-bg: hsla(145 50% 35% / 0.28);
  background-color: var(--_row-bg);
}

.table-success:hover {
  background-color: var(--_row-hover-bg);
}
```

Use the exact patterns from 03-RESEARCH.md Example 1 (HOVER STATES section) and Example 3 (Table Row Status Colors).
  </action>
  <verify>
```bash
grep -q ":where(:hover)" app/static/css/components/_tables.css && echo "Low-specificity hover"
grep -q 'data-bs-theme="dark"' app/static/css/components/_tables.css && echo "Dark mode hover"
grep -q 'data-bs-theme="light"' app/static/css/components/_tables.css && echo "Light mode hover"
```
  </verify>
  <done>
Theme-adaptive hover states complete with dark/light mode variants and status row colors.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add _tables.css import to main.css</name>
  <files>app/static/css/main.css</files>
  <action>
Add the import statement for `_tables.css` in the Components section of main.css.

Find the commented section:
```css
/* Components - Reusable UI patterns (Phase 2)
   @import url('./components/_buttons.css') layer(components);
   @import url('./components/_cards.css') layer(components);
*/
```

Add the tables import (uncommented, active) after the existing component comments:
```css
/* Components - Reusable UI patterns */
@import url('./components/_tables.css') layer(components);
```

Ensure the import comes AFTER the @layer declaration at the top and follows the established pattern.

Note: Leave other component imports commented until those phases execute.
  </action>
  <verify>
```bash
grep -q "@import url('./components/_tables.css') layer(components)" app/static/css/main.css && echo "Import added"
```
  </verify>
  <done>
main.css imports _tables.css in the components layer, making table styling available system-wide.
  </done>
</task>

</tasks>

<verification>
```bash
# Verify sticky header implementation
grep -c "position: sticky" app/static/css/components/_tables.css
# Expected: at least 2 (header + optional first column)

# Verify theme-adaptive hover
grep -c "data-bs-theme" app/static/css/components/_tables.css
# Expected: at least 2 (dark + light)

# Verify main.css integration
grep "@import.*_tables" app/static/css/main.css
# Expected: uncommented import line

# Verify no !important usage (layer system handles specificity)
grep -c "!important" app/static/css/components/_tables.css
# Expected: 0
```
</verification>

<success_criteria>
1. Sticky headers apply to `<th>` elements with solid background and z-index: 10
2. Hover states use `:where()` for low specificity
3. Dark mode uses light overlay, light mode uses dark overlay
4. Status row colors (table-success, table-warning) work in both themes
5. main.css imports _tables.css in components layer
6. Zero `!important` declarations in _tables.css
</success_criteria>

<output>
After completion, create `.planning/phases/03-table-system/03-02-SUMMARY.md`
</output>
