---
phase: 06-medium-traffic-migration
plan: 07
type: execute
wave: 4
depends_on: ["06-01"]
files_modified:
  - app/templates/motochefe/**/*.html
  - app/static/css/modules/_motochefe.css
autonomous: true

must_haves:
  truths:
    - "Motochefe templates (excluding 2 print templates) use design tokens"
    - "Templates render correctly in dark mode"
    - "45 non-print templates migrated"
  artifacts:
    - path: "app/static/css/modules/_motochefe.css"
      provides: "Motochefe module extracted styles"
      contains: "@layer modules"
  key_links:
    - from: "app/templates/motochefe/**/*.html"
      to: "app/static/css/modules/_motochefe.css"
      via: "main.css imports"
      pattern: "var\\(--"
---

<objective>
Migrate motochefe module (large subsystem with 47 templates)

Purpose: Handle large module with 97 colors, 108 inline styles, excluding 2 print templates
Output: Motochefe subsystem migrated with 45 templates using design tokens
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-medium-traffic-migration/06-RESEARCH.md
@app/static/css/modules/_financeiro.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Analyze motochefe structure and identify print templates</name>
  <files>
    app/templates/motochefe/**/*.html
  </files>
  <action>
1. List motochefe template structure:
   ```bash
   find app/templates/motochefe -name "*.html" | head -50
   ```
2. Identify print templates to EXCLUDE (per Phase 5 decision [05-04]):
   - motochefe/produtos/motos/imprimir_devolucao.html
   - motochefe/vendas/pedidos/imprimir.html
3. Categorize remaining templates by subdirectory:
   - produtos/ (product management)
   - vendas/ (sales management)
   - financeiro/ (if exists)
   - outros/ (other subsystems)
4. Document template count per category for organized migration

Note: 47 templates total, 45 non-print to migrate.
High inline style count (108) indicates significant extraction needed.
  </action>
  <verify>
    find app/templates/motochefe -name "*.html" | wc -l
    find app/templates/motochefe -name "*imprimir*.html"
  </verify>
  <done>Motochefe structure analyzed, print templates identified for exclusion</done>
</task>

<task type="auto">
  <name>Task 2: Migrate motochefe templates and extract styles</name>
  <files>
    app/templates/motochefe/**/*.html
    app/static/css/modules/_motochefe.css
  </files>
  <action>
1. Design class naming convention for motochefe:
   - .moto-card-* for card components
   - .moto-status-* for status indicators
   - .moto-table-* for table-specific styles
   - .moto-form-* for form components
2. Scan all 45 non-print templates for:
   - Inline style blocks
   - Hardcoded hex colors
   - Repeated patterns
3. Extract patterns to _motochefe.css:
   - Dashboard cards
   - Status badges
   - Table row states
   - Form validation states
4. Replace hardcoded colors with design tokens
5. Remove inline styles where patterns were extracted

High inline style count (108) indicates significant extraction.
Focus on most repeated patterns first.

Token mapping:
- #fff -> var(--bg-light)
- #f8f9fa -> var(--bg)
- #212529 -> var(--text)
- #6c757d -> var(--text-muted)
- #dee2e6 -> var(--border)
- #28a745 -> var(--semantic-success)
- #dc3545 -> var(--semantic-danger)
- #ffc107 -> var(--amber-50)

SKIP these print templates:
- motochefe/produtos/motos/imprimir_devolucao.html
- motochefe/vendas/pedidos/imprimir.html
  </action>
  <verify>
    grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/motochefe/ --include="*.html" | grep -v "{#" | grep -v "imprimir" | wc -l
    grep "@layer modules" app/static/css/modules/_motochefe.css
    wc -l app/static/css/modules/_motochefe.css
  </verify>
  <done>Motochefe templates (45 non-print) migrated to design tokens</done>
</task>

</tasks>

<verification>
1. Run: `grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/motochefe/ --include="*.html" | grep -v "{#" | grep -v "imprimir" | wc -l`
   Expected: Near zero

2. Verify print templates unchanged:
   ```bash
   grep "#" app/templates/motochefe/produtos/motos/imprimir_devolucao.html | head -5
   ```
   Expected: Hardcoded colors still present

3. Check extracted styles:
   `wc -l app/static/css/modules/_motochefe.css` > 100 lines
   Expected: Significant extraction given 108 inline styles

4. Visual check: Load motochefe templates in dark mode
   Expected: Correct rendering with appropriate contrast
</verification>

<success_criteria>
- 45 non-print motochefe templates migrated
- 2 print templates (imprimir_*.html) excluded per Phase 5 decision
- _motochefe.css contains extracted patterns (100+ lines expected)
- All migrated templates render correctly in dark mode
- Print templates maintain hardcoded light mode colors
</success_criteria>

<output>
After completion, create `.planning/phases/06-medium-traffic-migration/06-07-SUMMARY.md`
</output>
