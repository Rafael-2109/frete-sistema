---
phase: 06-medium-traffic-migration
plan: 11
type: execute
wave: 5
depends_on: ["06-01"]
files_modified:
  - app/templates/manufatura/*.html
  - app/static/css/modules/_manufatura.css
autonomous: true

must_haves:
  truths:
    - "Manufatura templates fully migrated (partial theme-aware extended)"
    - "Existing var(--bs-*) verified working in dark mode"
    - "Remaining hardcoded colors replaced with design tokens"
  artifacts:
    - path: "app/static/css/modules/_manufatura.css"
      provides: "Manufatura module overrides"
      contains: "@layer modules"
  key_links:
    - from: "app/templates/manufatura/*.html"
      to: "app/static/css/modules/_manufatura.css"
      via: "main.css imports"
      pattern: "var\\(--"
---

<objective>
Complete manufatura module migration (already partially theme-aware)

Purpose: Verify existing Bootstrap variables work and migrate remaining 26 hardcoded colors
Output: Manufatura fully migrated with semantic color coding preserved
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-medium-traffic-migration/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify and complete manufatura migration</name>
  <files>
    app/templates/manufatura/*.html
    app/static/css/modules/_manufatura.css
  </files>
  <action>
Research indicates manufatura already uses Bootstrap CSS variables:
```css
background-color: var(--bs-tertiary-bg, #f8f9fa);
color: var(--bs-body-color);
```

1. Identify current var(--bs-*) usage:
   ```bash
   grep -r "var(--bs-" app/templates/manufatura/ --include="*.html" | head -20
   ```

2. Verify these work in dark mode:
   - --bs-tertiary-bg should switch in dark mode
   - --bs-body-color should switch in dark mode

3. Find remaining hardcoded colors (26 total):
   ```bash
   grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/manufatura/ --include="*.html" | grep -v "{#" | grep -v "programacao_linhas_print"
   ```

4. Replace remaining hardcoded colors with design tokens:
   - If production-related semantic colors: Consider if they should stay
   - Standard colors: Replace with tokens

5. SKIP print template: programacao_linhas_print.html

Production views may use semantic color coding for:
- Line status (running, stopped, maintenance)
- Product type indicators
- Shift indicators

Document any intentionally preserved colors in _manufatura.css header.

Token mapping (for non-semantic colors):
- #fff -> var(--bg-light)
- #f8f9fa -> var(--bg)
- #212529 -> var(--text)
- #6c757d -> var(--text-muted)
- #dee2e6 -> var(--border)
  </action>
  <verify>
    grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/manufatura/ --include="*.html" | grep -v "{#" | grep -v "programacao_linhas_print" | wc -l
    grep "var(--" app/templates/manufatura/*.html | head -10
  </verify>
  <done>Manufatura templates fully migrated (26 colors addressed)</done>
</task>

<task type="auto">
  <name>Task 2: Verify Tier 4 modules are clean</name>
  <files>
    app/templates/separacao/*.html
    app/templates/faturamento/*.html
    app/templates/localidades/*.html
    app/templates/auth/*.html
    app/templates/metricas/*.html
    app/templates/relatorios_fiscais/*.html
    app/templates/transportadoras/*.html
    app/templates/permissions/*.html
    app/templates/tabelas/*.html
    app/templates/cadastros_agendamento/*.html
    app/templates/odoo/*.html
    app/templates/veiculos/*.html
    app/templates/vinculo/*.html
    app/templates/main/*.html
  </files>
  <action>
Research indicates Tier 4 modules have 0 hardcoded colors.

Verify these modules are clean (no action needed):
1. separacao (2 templates)
2. faturamento (8 templates)
3. localidades (5 templates)
4. auth (6 templates)
5. metricas (1 template)
6. relatorios_fiscais (2 templates)
7. transportadoras (2 templates)
8. permissions (2 templates)
9. tabelas (5 templates)
10. cadastros_agendamento (3 templates)
11. odoo (4 templates)
12. veiculos (1 template)
13. vinculo (3 templates)
14. main (1 template)

Run verification:
```bash
grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/separacao/ app/templates/faturamento/ app/templates/localidades/ app/templates/auth/ app/templates/metricas/ app/templates/relatorios_fiscais/ app/templates/transportadoras/ app/templates/permissions/ app/templates/tabelas/ app/templates/cadastros_agendamento/ app/templates/odoo/ app/templates/veiculos/ app/templates/vinculo/ app/templates/main/ --include="*.html" | grep -v "{#" | wc -l
```

If any hardcoded colors found, migrate them.
If clean as expected, document verification in summary.
  </action>
  <verify>
    grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/separacao/ app/templates/faturamento/ app/templates/localidades/ app/templates/auth/ app/templates/metricas/ app/templates/relatorios_fiscais/ app/templates/transportadoras/ app/templates/permissions/ app/templates/tabelas/ app/templates/cadastros_agendamento/ app/templates/odoo/ app/templates/veiculos/ app/templates/vinculo/ app/templates/main/ --include="*.html" 2>/dev/null | grep -v "{#" | wc -l
  </verify>
  <done>Tier 4 modules verified clean (0 hardcoded colors)</done>
</task>

</tasks>

<verification>
1. Run manufatura color count:
   `grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/manufatura/ --include="*.html" | grep -v "{#" | grep -v "programacao_linhas_print" | wc -l`
   Expected: Near zero

2. Run Tier 4 verification:
   ```bash
   grep -r "#[0-9a-fA-F]\{3,6\}" app/templates/separacao/ app/templates/faturamento/ app/templates/localidades/ app/templates/auth/ --include="*.html" 2>/dev/null | grep -v "{#" | wc -l
   ```
   Expected: 0

3. Visual check: Load manufatura production view in dark mode
   Expected: Semantic colors preserved, backgrounds/text adapt to theme
</verification>

<success_criteria>
- Manufatura templates fully migrated (print template excluded)
- Existing var(--bs-*) verified working in dark mode
- Remaining 26 hardcoded colors replaced or documented
- Tier 4 modules confirmed clean
- Semantic color coding preserved where intentional
</success_criteria>

<output>
After completion, create `.planning/phases/06-medium-traffic-migration/06-11-SUMMARY.md`
</output>
