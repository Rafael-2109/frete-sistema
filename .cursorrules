# ðŸŽ¯ CURSOR RULES - SISTEMA FRETES
# ===============================

Este Ã© um sistema Flask complexo com arquitetura de orquestradores e sistema de IA integrado.

## ðŸ—ï¸ ESTRUTURA DO PROJETO

### Principais MÃ³dulos:
- `app/claude_ai_novo/` - Sistema de IA integrado (Anthropic Claude)
- `app/fretes/` - GestÃ£o de fretes e cotaÃ§Ãµes
- `app/pedidos/` - GestÃ£o de pedidos
- `app/embarques/` - Controle de embarques e separaÃ§Ã£o
- `app/financeiro/` - GestÃ£o financeira e faturamento
- `app/transportadoras/` - Cadastro de transportadoras

### Arquitetura Claude AI Novo:
```
claude_ai_novo/
â”œâ”€â”€ orchestrators/     # CoordenaÃ§Ã£o de processos complexos
â”œâ”€â”€ processors/        # Processamento de dados e contexto
â”œâ”€â”€ analyzers/         # AnÃ¡lise de consultas e intenÃ§Ãµes
â”œâ”€â”€ mappers/          # Mapeamento semÃ¢ntico de dados
â”œâ”€â”€ validators/       # ValidaÃ§Ã£o de dados e estruturas
â”œâ”€â”€ coordinators/     # CoordenaÃ§Ã£o de agentes
â”œâ”€â”€ providers/        # Provedores de dados
â”œâ”€â”€ utils/           # UtilitÃ¡rios e classes base
â””â”€â”€ config/          # ConfiguraÃ§Ãµes
```

## ðŸ”§ COMANDOS ESSENCIAIS

### Para testar o sistema:
```bash
# ValidaÃ§Ã£o completa do sistema
python app/claude_ai_novo/validador_sistema_real.py

# Status rÃ¡pido
python app/claude_ai_novo/check_status.py

# Monitor em tempo real
python app/claude_ai_novo/monitoring/cursor_monitor.py

# Iniciar Flask
python run.py
```

### Para debugging:
- Use as configuraÃ§Ãµes de debug no workspace (`frete_sistema.code-workspace`)
- Testes de API disponÃ­veis em `api_tests.http`
- Monitor integrado em `monitoring/cursor_monitor.py`

## ðŸš¨ PROBLEMAS CONHECIDOS E SOLUÃ‡Ã•ES

### 1. UTF-8 Encoding Issues
**Problema**: 'utf-8' codec can't decode byte 0xe3
**SoluÃ§Ã£o**: Verificar DATABASE_URL, configuraÃ§Ãµes de PostgreSQL

### 2. Import Errors
**Problema**: Imports circulares entre mÃ³dulos
**SoluÃ§Ã£o**: 
- Usar imports relativos corretos
- Verificar com: `python -m py_compile arquivo.py`

### 3. Claude AI Configuration
**Problema**: ANTHROPIC_API_KEY nÃ£o configurada
**SoluÃ§Ã£o**: 
- Configurar variÃ¡vel ambiente
- Verificar `app/claude_ai_novo/config/__init__.py`

### 4. Processador Response
**Problema**: ResponseProcessor import error
**LocalizaÃ§Ã£o**: `app/claude_ai_novo/processors/response_processor.py`

## ðŸ“‹ REGRAS DE DESENVOLVIMENTO

### Ao fazer alteraÃ§Ãµes:
1. **SEMPRE** rodar o validador primeiro:
   ```bash
   python app/claude_ai_novo/validador_sistema_real.py
   ```

2. **SEMPRE** verificar imports nÃ£o quebram:
   ```bash
   python -c "from app.claude_ai_novo import *"
   ```

3. **SEMPRE** seguir arquitetura por responsabilidade:
   - `analyzers/` para anÃ¡lise
   - `processors/` para processamento
   - `orchestrators/` para coordenaÃ§Ã£o

### PadrÃµes de CÃ³digo:
- Usar logging: `logger = logging.getLogger(__name__)`
- Docstrings obrigatÃ³rias em classes e mÃ©todos principais
- Tratamento de erros com fallbacks
- Imports organizados: padrÃ£o â†’ externos â†’ locais

### Estrutura de Arquivos:
```python
"""
Docstring explicando responsabilidade do arquivo
"""

import logging
from typing import Dict, List, Optional, Any

# Imports locais
from ..utils.base_classes import BaseProcessor

logger = logging.getLogger(__name__)

class MinhaClasse(BaseProcessor):
    """Classe que faz X"""
    
    def __init__(self):
        super().__init__()
        logger.info(f"{self.__class__.__name__} inicializado")
```

## ðŸ§ª TESTING E VALIDAÃ‡ÃƒO

### Workflow de Testes:
1. **Unit Tests**: MÃ©todos individuais
2. **Integration Tests**: MÃ³dulos completos  
3. **System Tests**: Sistema como um todo
4. **API Tests**: Endpoints (`api_tests.http`)

### Ferramentas DisponÃ­veis:
- `validador_sistema_real.py` - ValidaÃ§Ã£o completa
- `check_status.py` - Status rÃ¡pido
- `cursor_monitor.py` - Monitoramento em tempo real
- `api_tests.http` - Testes de API

## ðŸ”— INTEGRAÃ‡ÃƒO COM CURSOR

### ExtensÃµes Recomendadas:
- Python (ms-python.python)
- REST Client (humao.rest-client)
- Error Lens (usernamehw.errorlens)
- GitLens (eamodio.gitlens)

### Tasks Configuradas:
- `ðŸš€ Start Flask Development` - Inicia servidor
- `ðŸ” Run System Validator` - Valida sistema
- `ðŸ“Š System Health Check` - Status rÃ¡pido
- `ðŸ”§ Fix Critical Issues` - CorreÃ§Ãµes

### Debugging:
- `ðŸŒ Flask App (Debug)` - Debug do Flask
- `ðŸ§ª Claude AI Tests` - Debug do Claude AI
- `âš¡ Quick Status Check` - Status check

## ðŸƒâ€â™‚ï¸ QUICK START NO CURSOR

### 1. Abrir Workspace:
```bash
# No Cursor:
File > Open Workspace > frete_sistema.code-workspace
```

### 2. Configurar Python:
```bash
# Ctrl+Shift+P > "Python: Select Interpreter"
# Selecionar: ./venv/Scripts/python.exe
```

### 3. Iniciar Desenvolvimento:
```bash
# Terminal integrado:
python run.py

# Ou Task: Ctrl+Shift+P > "Tasks: Run Task" > "ðŸš€ Start Flask Development"
```

### 4. Testar APIs:
```bash
# Abrir: api_tests.http
# Usar REST Client para testar endpoints
```

### 5. Monitor em Tempo Real:
```bash
# Terminal separado:
python app/claude_ai_novo/monitoring/cursor_monitor.py
```

## ðŸŽ¯ METAS DE QUALIDADE

### MÃ©tricas Alvo:
- **System Score**: > 95%
- **Import Success**: 100%
- **API Response Time**: < 500ms
- **Error Rate**: < 1%

### ValidaÃ§Ã£o ContÃ­nua:
- Rodar validador antes de commits
- Monitor durante desenvolvimento
- API tests para mudanÃ§as crÃ­ticas
- Performance tests semanais

## ðŸ“š DOCUMENTAÃ‡ÃƒO ADICIONAL

### Arquivos de ReferÃªncia:
- `GUIA_CONFIGURACAO_CURSOR.md` - Setup detalhado
- `PLANO_CORRECAO_CRITICA.md` - Issues conhecidos
- `STATUS_VALIDACAO_FINAL.md` - Status atual
- `GARANTIA_TOTAL_FUNCIONAMENTO.md` - Processo de qualidade

### Logs de ProduÃ§Ã£o:
- Render: `https://sistema-fretes.onrender.com`
- Logs disponÃ­veis via dashboard do Render
- Alertas crÃ­ticos via sistema de monitoramento

---

## ðŸ’¡ DICAS PARA O CURSOR

### Composer Integration:
Quando usar o Composer, mencione:
- "Sistema Flask com arquitetura de orquestradores"
- "Claude AI Novo para processamento inteligente"  
- "Validador sistema real para verificaÃ§Ãµes"
- "Arquitetura por responsabilidade (analyzers, processors, etc.)"

### Context Awareness:
- Use `validador_sistema_real.py` para entender estado atual
- Check `api_tests.http` para endpoints disponÃ­veis
- Monitor real-time com `cursor_monitor.py`
- Consulte logs de produÃ§Ã£o para debugging

### Performance Tips:
- Use tasks predefinidas (Ctrl+Shift+P > Tasks)
- Monitor em terminal separado
- REST Client para API testing
- Debug integrado do Python 