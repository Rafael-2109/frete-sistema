{
  "resource": {
    "uri": "frete://schemas/{domain}",
    "name": "Domain Schema Information",
    "description": "Provides detailed schema information for each domain in the freight system",
    "mimeType": "application/json",
    "parameters": {
      "domain": {
        "type": "string",
        "enum": ["fretes", "pedidos", "entregas", "embarques", "financeiro", "transportadoras", "monitoramento"],
        "description": "The domain to retrieve schema for"
      }
    },
    "schemas": {
      "fretes": {
        "name": "Fretes",
        "description": "Freight management and pricing",
        "tables": {
          "fretes": {
            "primaryKey": "id",
            "fields": {
              "id": { "type": "uuid", "required": true },
              "numero": { "type": "string", "required": true, "unique": true },
              "pedido_id": { "type": "uuid", "foreignKey": "pedidos.id" },
              "transportadora_id": { "type": "uuid", "foreignKey": "transportadoras.id" },
              "valor_frete": { "type": "decimal", "precision": 10, "scale": 2 },
              "peso_total": { "type": "decimal", "precision": 10, "scale": 3 },
              "volume_total": { "type": "decimal", "precision": 10, "scale": 3 },
              "distancia_km": { "type": "decimal", "precision": 10, "scale": 2 },
              "prazo_entrega": { "type": "integer", "description": "Days" },
              "tipo_carga": { "type": "string", "enum": ["seca", "refrigerada", "perigosa", "fragil"] },
              "status": { "type": "string", "enum": ["cotacao", "aprovado", "em_transito", "entregue", "cancelado"] },
              "origem": { "type": "jsonb", "structure": { "cidade": "string", "uf": "string", "cep": "string" } },
              "destino": { "type": "jsonb", "structure": { "cidade": "string", "uf": "string", "cep": "string" } },
              "created_at": { "type": "timestamp", "default": "now()" },
              "updated_at": { "type": "timestamp", "default": "now()" }
            },
            "indexes": ["numero", "pedido_id", "transportadora_id", "status", "created_at"],
            "relations": {
              "pedido": { "type": "belongsTo", "model": "pedidos" },
              "transportadora": { "type": "belongsTo", "model": "transportadoras" },
              "rastreamentos": { "type": "hasMany", "model": "rastreamentos" }
            }
          }
        },
        "businessRules": [
          "Freight value must be greater than zero",
          "Delivery deadline must be realistic based on distance",
          "Status transitions must follow defined workflow"
        ]
      },
      "pedidos": {
        "name": "Pedidos",
        "description": "Order management system",
        "tables": {
          "pedidos": {
            "primaryKey": "id",
            "fields": {
              "id": { "type": "uuid", "required": true },
              "numero": { "type": "string", "required": true, "unique": true },
              "cliente_id": { "type": "uuid", "foreignKey": "clientes.id" },
              "valor_total": { "type": "decimal", "precision": 10, "scale": 2 },
              "data_pedido": { "type": "timestamp", "required": true },
              "data_entrega_prevista": { "type": "timestamp" },
              "status": { "type": "string", "enum": ["novo", "processando", "aguardando_frete", "em_transito", "entregue", "cancelado"] },
              "observacoes": { "type": "text" },
              "endereco_entrega": { "type": "jsonb" },
              "items": { "type": "jsonb", "array": true },
              "created_at": { "type": "timestamp", "default": "now()" },
              "updated_at": { "type": "timestamp", "default": "now()" }
            },
            "indexes": ["numero", "cliente_id", "status", "data_pedido"],
            "relations": {
              "cliente": { "type": "belongsTo", "model": "clientes" },
              "fretes": { "type": "hasMany", "model": "fretes" },
              "entregas": { "type": "hasMany", "model": "entregas" }
            }
          }
        }
      },
      "entregas": {
        "name": "Entregas",
        "description": "Delivery tracking and management",
        "tables": {
          "entregas": {
            "primaryKey": "id",
            "fields": {
              "id": { "type": "uuid", "required": true },
              "codigo": { "type": "string", "required": true, "unique": true },
              "pedido_id": { "type": "uuid", "foreignKey": "pedidos.id" },
              "frete_id": { "type": "uuid", "foreignKey": "fretes.id" },
              "data_saida": { "type": "timestamp" },
              "data_entrega_prevista": { "type": "timestamp" },
              "data_entrega_realizada": { "type": "timestamp" },
              "status": { "type": "string", "enum": ["preparando", "em_rota", "entregue", "devolvido", "extraviado"] },
              "motorista_id": { "type": "uuid", "foreignKey": "motoristas.id" },
              "veiculo_id": { "type": "uuid", "foreignKey": "veiculos.id" },
              "assinatura": { "type": "jsonb" },
              "foto_comprovante": { "type": "string" },
              "ocorrencias": { "type": "jsonb", "array": true },
              "created_at": { "type": "timestamp", "default": "now()" },
              "updated_at": { "type": "timestamp", "default": "now()" }
            },
            "indexes": ["codigo", "pedido_id", "frete_id", "status", "data_entrega_prevista"],
            "relations": {
              "pedido": { "type": "belongsTo", "model": "pedidos" },
              "frete": { "type": "belongsTo", "model": "fretes" },
              "motorista": { "type": "belongsTo", "model": "motoristas" },
              "veiculo": { "type": "belongsTo", "model": "veiculos" }
            }
          }
        }
      },
      "financeiro": {
        "name": "Financeiro",
        "description": "Financial management and billing",
        "tables": {
          "faturas": {
            "primaryKey": "id",
            "fields": {
              "id": { "type": "uuid", "required": true },
              "numero": { "type": "string", "required": true, "unique": true },
              "cliente_id": { "type": "uuid", "foreignKey": "clientes.id" },
              "valor_total": { "type": "decimal", "precision": 10, "scale": 2 },
              "data_emissao": { "type": "timestamp" },
              "data_vencimento": { "type": "timestamp" },
              "data_pagamento": { "type": "timestamp" },
              "status": { "type": "string", "enum": ["pendente", "pago", "vencido", "cancelado"] },
              "forma_pagamento": { "type": "string", "enum": ["boleto", "pix", "cartao", "transferencia"] },
              "fretes": { "type": "jsonb", "array": true },
              "created_at": { "type": "timestamp", "default": "now()" },
              "updated_at": { "type": "timestamp", "default": "now()" }
            },
            "indexes": ["numero", "cliente_id", "status", "data_vencimento"]
          }
        }
      }
    }
  }
}